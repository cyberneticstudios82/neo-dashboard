<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aurora - Autonomous Trading Terminal</title>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--cyan:#00f5ff;--green:#00ff88;--red:#ff3366;--gold:#ffd700;--bg:#020406;--panel:rgba(8,18,28,0.95);--border:rgba(0,245,255,0.15)}
body{font-family:'Rajdhani',sans-serif;background:var(--bg);color:#e8f4ff;overflow-x:hidden;height:100vh}
#canvas{position:fixed;inset:0;z-index:0}

.terminal{position:relative;z-index:10;display:grid;grid-template-rows:50px 1fr;grid-template-columns:280px 1fr 320px;gap:8px;padding:8px;height:100vh;background:linear-gradient(180deg,rgba(2,4,6,0.97),rgba(2,4,6,0.9))}

.header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;padding:0 20px;background:var(--panel);border:1px solid var(--border);border-radius:8px}
.logo{font-family:'Orbitron';font-size:18px;font-weight:900;background:linear-gradient(90deg,var(--cyan),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.status{display:flex;gap:20px;align-items:center}
.status-item{display:flex;align-items:center;gap:6px;font-size:12px;color:#6a7a8a}
.pulse{width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 10px var(--green);animation:pulse 1.5s infinite}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.6;transform:scale(0.9)}}

.sidebar{background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:15px;overflow-y:auto}
.sidebar h3{font-family:'Orbitron';font-size:11px;color:var(--cyan);text-transform:uppercase;margin-bottom:15px;letter-spacing:2px;padding-bottom:8px;border-bottom:1px solid var(--border)}

.agent-card{background:rgba(0,0,0,0.3);border-radius:8px;padding:12px;margin-bottom:10px;border-left:3px solid #334;border-transition:all 0.3s}
.agent-card.active{border-left-color:var(--green);background:rgba(0,255,136,0.08)}
.agent-card .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.agent-icon{font-size:20px}
.agent-name{font-family:'Orbitron';font-size:12px;font-weight:700}
.agent-status{font-size:9px;padding:2px 6px;border-radius:4px;background:rgba(0,255,136,0.2);color:var(--green)}
.agent-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px}
.agent-stat-label{color:#5a6a7a}
.agent-stat-val{font-family:'JetBrains Mono';font-weight:700}

.market-ticker{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:15px}
.ticker{background:rgba(0,0,0,0.4);border-radius:6px;padding:12px;text-align:center}
.ticker-symbol{font-family:'Orbitron';font-size:12px;color:#6a7a8a}
.ticker-price{font-family:'JetBrains Mono';font-size:18px;font-weight:700;margin:5px 0}
.ticker-change{font-size:11px}
.up{color:var(--green)}.down{color:var(--red)}

.main{display:flex;flex-direction:column;gap:8px}
.stats-bar{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.stat-box{background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:15px;text-align:center}
.stat-box h4{font-size:10px;color:#6a7a8a;text-transform:uppercase;margin-bottom:8px}
.stat-value{font-family:'JetBrains Mono';font-size:24px;font-weight:700}
.stat-value.cyan{color:var(--cyan)}.stat-value.green{color:var(--green)}.stat-value.red{color:var(--red)}.stat-value.gold{color:var(--gold)}

.chart-section{flex:1;background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:15px;display:flex;flex-direction:column}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}
.chart-header h3{font-family:'Orbitron';font-size:12px;color:var(--cyan)}
.chart-container{flex:1;position:relative;min-height:200px}
#pnlChart{width:100%;height:100%}

.rightbar{background:var(--panel);border:1px solid var(--border);border-radius:8px;padding:15px;overflow-y:auto}
.trades-section{flex:1;overflow-y:auto}
.trade-row{background:rgba(0,0,0,0.3);border-radius:6px;padding:10px;margin-bottom:8px;border-left:3px solid var(--cyan);display:flex;flex-direction:column;gap:4px}
.trade-row.win{border-left-color:var(--green)}
.trade-row.loss{border-left-color:var(--red)}
.trade-header{display:flex;justify-content:space-between;align-items:center}
.trade-signal{font-family:'Orbitron';font-size:12px;font-weight:700}
.trade-token{font-size:11px;color:#6a7a8a}
.trade-result{font-family:'JetBrains Mono';font-size:12px;font-weight:700}
.trade-result.win{color:var(--green)}.trade-result.loss{color:var(--red)}
.trade-reason{font-size:10px;color:#5a6a7a;font-style:italic;margin-top:4px}
.trade-time{font-size:9px;color:#4a5a6a}

.activity-row{padding:8px;margin:4px 0;background:rgba(0,0,0,0.2);border-radius:4px;font-size:10px;color:#5a6a7a;border-left:2px solid var(--cyan)}

#loading{position:fixed;inset:0;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}
.loader{width:60px;height:60px;border:3px solid var(--border);border-top-color:var(--cyan);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loader-text{font-family:'Orbitron';font-size:12px;color:var(--cyan);margin-top:20px;letter-spacing:3px}

@keyframes slideIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.animate{animation:slideIn 0.3s ease}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="loading"><div class="loader"></div><div class="loader-text">INITIALIZING AURORA</div></div>

<div class="terminal">
  <div class="header">
    <div class="logo">‚óÜ AURORA OMEGA</div>
    <div class="status">
      <div class="status-item"><div class="pulse"></div><span>AUTONOMOUS TRADING</span></div>
      <div class="status-item">ü§ñ <span id="agentsOnline">7</span> AGENTS</div>
      <div class="status-item">üí∞ <span id="uptime">00:00:00</span></div>
    </div>
  </div>
  
  <div class="sidebar">
    <h3>ü§ñ AGENTS</h3>
    <div class="agent-card active" id="aurora">
      <div class="top"><span class="agent-icon">üåô</span><span class="agent-name">AURORA</span><span class="agent-status">TRADING</span></div>
      <div class="agent-stats">
        <div><span class="agent-stat-label">Bank</span><div class="agent-stat-val" id="auroraBank">$0</div></div>
        <div><span class="agent-stat-label">P&L</span><div class="agent-stat-val" id="auroraPnl">$0</div></div>
        <div><span class="agent-stat-label">Trades</span><div class="agent-stat-val" id="auroraTrades">0</div></div>
        <div><span class="agent-stat-label">Wins</span><div class="agent-stat-val" id="auroraWins">0</div></div>
      </div>
    </div>
    
    <div class="agent-card active" id="hft">
      <div class="top"><span class="agent-icon">‚ö°</span><span class="agent-name">HFT</span><span class="agent-status">RUNNING</span></div>
      <div class="agent-stats">
        <div><span class="agent-stat-label">Bank</span><div class="agent-stat-val" id="hftBank">$0</div></div>
        <div><span class="agent-stat-label">P&L</span><div class="agent-stat-val" id="hftPnl">$0</div></div>
        <div><span class="agent-stat-label">Trades</span><div class="agent-stat-val" id="hftTrades">0</div></div>
        <div><span class="agent-stat-label">Wins</span><div class="agent-stat-val" id="hftWins">0</div></div>
      </div>
    </div>
    
    <div class="agent-card" id="market">
      <div class="top"><span class="agent-icon">üåê</span><span class="agent-name">MARKET</span><span class="agent-status" style="background:rgba(0,245,255,0.2);color:var(--cyan)">ANALYZING</span></div>
    </div>
    
    <div class="agent-card" id="risk">
      <div class="top"><span class="agent-icon">‚öñÔ∏è</span><span class="agent-name">RISK</span><span class="agent-status" style="background:rgba(0,245,255,0.2);color:var(--cyan)">MONITORING</span></div>
    </div>
    
    <div class="agent-card" id="sentiment">
      <div class="top"><span class="agent-icon">üì∞</span><span class="agent-name">SENTIMENT</span><span class="agent-status" style="background:rgba(0,245,255,0.2);color:var(--cyan)">TRACKING</span></div>
    </div>
    
    <div class="agent-card" id="research">
      <div class="top"><span class="agent-icon">üîç</span><span class="agent-name">RESEARCH</span><span class="agent-status" style="background:rgba(0,245,255,0.2);color:var(--cyan)">LEARNING</span></div>
    </div>
    
    <h3 style="margin-top:20px">üìà MARKETS</h3>
    <div class="market-ticker">
      <div class="ticker">
        <div class="ticker-symbol">BTC/USD</div>
        <div class="ticker-price" id="btcPrice">$0</div>
        <div class="ticker-change" id="btcChange">0.00%</div>
      </div>
      <div class="ticker">
        <div class="ticker-symbol">ETH/USD</div>
        <div class="ticker-price" id="ethPrice">$0</div>
        <div class="ticker-change" id="ethChange">0.00%</div>
      </div>
    </div>
  </div>
  
  <div class="main">
    <div class="stats-bar">
      <div class="stat-box"><h4>Total Bank</h4><div class="stat-value cyan" id="totalBank">$0</div></div>
      <div class="stat-box"><h4>Total P&L</h4><div class="stat-value green" id="totalPnl">$0</div></div>
      <div class="stat-box"><h4>Trades</h4><div class="stat-value" id="totalTrades">0</div></div>
      <div class="stat-box"><h4>Win Rate</h4><div class="stat-value gold" id="winRate">0%</div></div>
      <div class="stat-box"><h4>Best Trade</h4><div class="stat-value green" id="bestTrade">$0</div></div>
    </div>
    
    <div class="chart-section">
      <div class="chart-header">
        <h3>üìä P&L PERFORMANCE</h3>
        <div style="font-size:11px;color:#6a7a8a"><span style="color:var(--green)">‚óè</span> AURORA &nbsp; <span style="color:var(--gold)">‚óè</span> HFT</div>
      </div>
      <div class="chart-container"><canvas id="pnlChart"></canvas></div>
    </div>
  </div>
  
  <div class="rightbar">
    <h3>üéØ RECENT TRADES</h3>
    <div class="trades-section" id="tradesList"></div>
  </div>
</div>

<script>
// Three.js Background
var scene,camera,renderer,particles,time=0;
function init3D(){
  scene=new THREE.Scene();scene.background=new THREE.Color(0x020406);scene.fog=new THREE.FogExp2(0x020406,0.015);
  camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);camera.position.z=30;
  renderer=new THREE.WebGLRenderer({canvas:document.getElementById('canvas'),antialias:true});renderer.setSize(innerWidth,innerHeight);
  
  var light1=new THREE.PointLight(0x00f5ff,1,50);light1.position.set(15,15,15);scene.add(light1);
  var light2=new THREE.PointLight(0x00ff88,0.5,50);light2.position.set(-15,-15,15);scene.add(light2);
  
  var geometry=new THREE.BufferGeometry();var count=2000;
  var positions=new Float32Array(count*3),colors=new Float32Array(count*3);
  for(var i=0;i<count;i++){
    positions[i*3]=(Math.random()-0.5)*80;positions[i*3+1]=(Math.random()-0.5)*80;positions[i*3+2]=(Math.random()-0.5)*40;
    var c=new THREE.Color();c.setHSL(0.5+Math.random()*0.3,0.9,0.5);colors[i*3]=c.r;colors[i*3+1]=c.g;colors[i*3+2]=c.b;
  }
  geometry.setAttribute('position',new THREE.BufferAttribute(positions,3));
  geometry.setAttribute('color',new THREE.BufferAttribute(colors,3));
  particles=new THREE.Points(geometry,new THREE.PointsMaterial({size:0.12,vertexColors:true,transparent:true,opacity:0.8,blending:THREE.AdditiveBlending}));
  scene.add(particles);
  
  var grid=new THREE.GridHelper(100,50,0x00f5ff,0x0a1520);grid.position.y=-20;scene.add(grid);
  animate();
}
function animate(){requestAnimationFrame(animate);time+=0.001;particles.rotation.y=time*0.08;particles.rotation.x=Math.sin(time*0.3)*0.1;camera.position.x=Math.sin(time*0.5)*5;camera.position.y=Math.cos(time*0.7)*3;camera.lookAt(0,0,0);renderer.render(scene,camera);}

// Data
var aurora={bank:100,pnl:0,trades:0,wins:0},hft={bank:100,pnl:0,trades:0,wins:0},trades=[],pnlHistoryA=[],pnlHistoryH=[];

// Fetch data
async function fetchData(){
  try{
    var r1=await fetch('/api/aurora'),d1=await r1.json();
    var r2=await fetch('/api/hft'),d2=await r2.json();
    var r3=await fetch('/api/trades'),d3=await r3.json();
    if(d1.bank>0)aurora=d1;
    if(d2.bank>0)hft=d2;
    trades=d3||[];
    
    pnlHistoryA.push(aurora.bank);
    pnlHistoryH.push(hft.bank);
    if(pnlHistoryA.length>50){pnlHistoryA.shift();pnlHistoryH.shift();}
  }catch(e){console.log(e);}
  updateDisplay();
}

// Update display
function updateDisplay(){
  var totalBank=aurora.bank+hft.bank;
  var totalPnl=aurora.pnl+hft.pnl;
  var totalTrades=aurora.trades+hft.trades;
  var totalWins=aurora.wins+hft.wins;
  var winRate=totalTrades>0?Math.round(totalWins/totalTrades*100):0;
  
  // Stats
  document.getElementById('totalBank').innerText='$'+totalBank.toFixed(2);
  var pnlEl=document.getElementById('totalPnl');
  pnlEl.innerText='$'+(totalPnl>=0?'+':'')+totalPnl.toFixed(2);
  pnlEl.className='stat-value '+(totalPnl>=0?'green':'red');
  document.getElementById('totalTrades').innerText=totalTrades;
  document.getElementById('winRate').innerText=winRate+'%';
  
  // Best trade
  var best=trades.reduce(function(m,t){return (t.profit||0)>(m.profit||0)?t:m;},trades[0]||{profit:0});
  document.getElementById('bestTrade').innerText='+$'+Math.abs(best.profit||0).toFixed(2);
  
  // Aurora
  document.getElementById('auroraBank').innerText='$'+aurora.bank.toFixed(2);
  var apEl=document.getElementById('auroraPnl');
  apEl.innerText='$'+(aurora.pnl>=0?'+':'')+aurora.pnl.toFixed(2);
  apEl.style.color=aurora.pnl>=0?'#00ff88':'#ff3366';
  document.getElementById('auroraTrades').innerText=aurora.trades;
  document.getElementById('auroraWins').innerText=aurora.wins;
  
  // HFT
  document.getElementById('hftBank').innerText='$'+hft.bank.toFixed(2);
  var hpEl=document.getElementById('hftPnl');
  hpEl.innerText='$'+(hft.pnl>=0?'+':'')+hft.pnl.toFixed(2);
  hpEl.style.color=hft.pnl>=0?'#00ff88':'#ff3366';
  document.getElementById('hftTrades').innerText=hft.trades;
  document.getElementById('hftWins').innerText=hft.wins;
  
  // Trades
  var list=document.getElementById('tradesList');
  list.innerHTML='';
  trades.slice(0,20).forEach(function(t,i){
    var profit=t.profit||0;
    var row=document.createElement('div');
    row.className='trade-row '+(t.result==='WIN'?'win':'loss')+' animate';
    row.style.animationDelay=(i*0.05)+'s';
    row.innerHTML='<div class="trade-header"><span class="trade-signal">'+t.signal+' '+t.token+(t.leverage?' <span style="color:#ffd700">'+t.leverage+'x</span>':'')+'</span><span class="trade-result '+(t.result==='WIN'?'win':'loss')+'>'+(profit>=0?'+$':'-$')+Math.abs(profit).toFixed(2)+'</span></div><div class="trade-time">'+new Date(t.time).toLocaleTimeString()+'</div><div class="trade-reason">'+(t.reasoning||'').substring(0,60)+'...</div>';
    list.appendChild(row);
  });
  
  // Chart
  drawChart();
  
  // Markets
  fetchPrices();
}

// Fetch prices
async function fetchPrices(){
  try{
    var btc=await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT').then(r=>r.json());
    var eth=await fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT').then(r=>r.json());
    document.getElementById('btcPrice').innerText='$'+parseFloat(btc.price).toLocaleString();
    document.getElementById('ethPrice').innerText='$'+parseFloat(eth.price).toLocaleString();
  }catch(e){}
}

// Draw chart
function drawChart(){
  var canvas=document.getElementById('pnlChart');
  var ctx=canvas.getContext('2d');
  canvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;
  var w=canvas.width,h=canvas.height;
  ctx.clearRect(0,0,w,h);
  
  if(pnlHistoryA.length<2)return;
  
  // Aurora line
  var mn=Math.min(...pnlHistoryA,...pnlHistoryH);
  var mx=Math.max(...pnlHistoryA,...pnlHistoryH);
  var range=mx-mn||1;
  
  ctx.strokeStyle='#00f5ff';ctx.lineWidth=2;ctx.beginPath();
  pnlHistoryA.forEach(function(v,i){var x=(i/(pnlHistoryA.length-1))*w,y=h-((v-mn)/range)*(h-30)-15;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);});
  ctx.stroke();
  
  // HFT line
  ctx.strokeStyle='#ffd700';ctx.lineWidth=2;ctx.beginPath();
  pnlHistoryH.forEach(function(v,i){var x=(i/(pnlHistoryH.length-1))*w,y=h-((v-mn)/range)*(h-30)-15;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);});
  ctx.stroke();
  
  // Grid
  ctx.strokeStyle='rgba(0,245,255,0.1)';ctx.lineWidth=1;
  for(var i=0;i<=4;i++){var y=(h/4)*i;ctx.beginPath();ctx.moveTo(0,y);ctx.lineTo(w,y);ctx.stroke();}
  
  // Current values
  ctx.fillStyle='#00f5ff';ctx.font='bold 12px Orbitron';
  ctx.fillText('$'+pnlHistoryA[pnlHistoryA.length-1].toFixed(0),w-50,20);
}

// Uptime
var startTime=Date.now();
setInterval(function(){
  var elapsed=Math.floor((Date.now()-startTime)/1000);
  var h=Math.floor(elapsed/3600).toString().padStart(2,'0');
  var m=Math.floor((elapsed%3600)/60).toString().padStart(2,'0');
  var s=(elapsed%60).toString().padStart(2,'0');
  document.getElementById('uptime').innerText=h+':'+m+':'+s;
},1000);

// Init
window.onload=function(){
  init3D();
  fetchData();
  setInterval(fetchData,2500);
  setTimeout(function(){document.getElementById('loading').style.display='none';},1000);
};
window.onresize=function(){camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);};
</script>
</body>
</html>
