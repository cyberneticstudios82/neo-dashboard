<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aurora - Autonomous Trading Empire</title>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--cyan:#00f5ff;--green:#00ff88;--red:#ff3366;--gold:#ffd700;--bg:#030508;--card:rgba(10,20,40,0.95);--border:rgba(0,245,255,0.2)}
body{font-family:'Rajdhani',sans-serif;background:var(--bg);color:#e0f4ff;overflow-x:hidden}
#c{position:fixed;inset:0;z-index:0}
.c{position:relative;z-index:10;max-width:1600px;margin:0 auto;padding:60px 15px 15px}
.h{position:fixed;top:0;right:0;left:0;height:50px;background:rgba(3,5,8,0.98);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 20px;z-index:100}
.l{font-family:'Orbitron';font-size:14px;font-weight:900;background:linear-gradient(135deg,var(--cyan),var(--gold));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.s{display:flex;gap:12px;align-items:center}
.sd{width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 8px var(--green);animation:pl 1s infinite}
@keyframes pl{0%,100%{opacity:1}50%{opacity:0.5}}
.r{display:grid;grid-template-columns:repeat(6,1fr);gap:10px;margin-bottom:15px}
.b{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:12px;text-align:center}
.b h3{font-size:9px;color:#6a7a8a;text-transform:uppercase;margin-bottom:4px}
.b .v{font-size:18px;font-weight:700;font-family:'Orbitron'}
.g3{display:grid;grid-template-columns:2fr 1fr;gap:15px}
.cr{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:15px;margin-bottom:15px}
.cr h2{font-family:'Orbitron';font-size:12px;color:var(--cyan);margin-bottom:12px}
.chart{height:180px;background:rgba(0,0,0,0.3);border-radius:6px;position:relative}
#pnlChart{width:100%;height:100%}
.agent{background:rgba(0,0,0,0.4);border-radius:6px;padding:10px;margin:6px 0;border-left:3px solid var(--cyan);display:flex;justify-content:space-between;align-items:center}
.agent.active{border-left-color:var(--green);background:rgba(0,255,136,0.08)}
.agent-i{font-size:20px}
.agent-n{font-weight:700;font-size:11px}
.agent-d{font-size:9px;color:#6a7a8a}
.agent-v{font-family:'Orbitron';font-size:12px}
.ti{padding:6px;margin:4px 0;background:rgba(0,0,0,0.3);border-left:2px solid var(--cyan);border-radius:4px;font-size:11px;display:flex;justify-content:space-between}
.ti.win{border-left-color:var(--green)}
.ti.loss{border-left-color:var(--red)}
.ts{font-size:10px;color:#6a7a8a}
#lo{position:fixed;inset:0;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}
.ld{width:40px;height:40px;border:3px solid transparent;border-top-color:var(--cyan);border-radius:50%;animation:sp 1s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}
.lt{font-family:'Orbitron';font-size:12px;color:var(--cyan);margin-top:15px}
</style>
</head>
<body>
<div id="lo"><div class="ld"></div><div class="lt">CONNECTING TO AURORA...</div></div>
<canvas id="c"></canvas>
<div class="h"><div class="l">‚óÜ AURORA OMEGA</div><div class="s"><div class="sd"></div><span style="font-size:11px">24/7 LIVE</span></div></div>
<div class="c">
<div class="r">
<div class="b"><h3>Total Bank</h3><div class="v cy" id="totalBank">$0</div></div>
<div class="b"><h3>Total P&L</h3><div class="v" id="totalPnl">$0</div></div>
<div class="b"><h3>Trades</h3><div class="v" id="totalTrades">0</div></div>
<div class="b"><h3>Win Rate</h3><div class="v gr" id="winRate">0%</div></div>
<div class="b"><h3>AURORA</h3><div class="v" id="auroraBank">$0</div></div>
<div class="b"><h3>HFT</h3><div class="v" id="hftBank">$0</div></div>
</div>
<div class="g3">
<div class="cr"><h2>üìà P&L CHART</h2><div class="chart"><canvas id="pnlChart"></canvas></div></div>
<div class="cr"><h2>ü§ñ AGENTS</h2>
<div class="agent active"><div class="agent-i">üåô</div><div><div class="agent-n">AURORA</div><div class="agent-d">Signal Trading</div></div><div class="agent-v" id="auroraVal">$0</div></div>
<div class="agent active"><div class="agent-i">‚ö°</div><div><div class="agent-n">HFT</div><div class="agent-d">Market Making</div></div><div class="agent-v" id="hftVal">$0</div></div>
<div class="agent"><div class="agent-i">üåê</div><div><div class="agent-n">MARKET</div><div class="agent-d">Analysis</div></div><div class="agent-v" style="color:var(--green)">ON</div></div>
<div class="agent"><div class="agent-i">‚öñÔ∏è</div><div><div class="agent-n">RISK</div><div class="agent-d">Protection</div></div><div class="agent-v" style="color:var(--green)">ON</div></div>
<div class="agent"><div class="agent-i">üì∞</div><div><div class="agent-n">SENTIMENT</div><div class="agent-d">Social</div></div><div class="agent-v" style="color:var(--green)">ON</div></div>
<div class="agent"><div class="agent-i">üîç</div><div><div class="agent-n">RESEARCH</div><div class="agent-d">Learning</div></div><div class="agent-v" style="color:var(--green)">ON</div></div>
</div>
</div>
<div class="cr" style="grid-column:1/-1"><h2>üìú RECENT TRADES</h2>
<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px">
<div id="trades1"></div>
<div id="trades2"></div>
</div>
</div>
</div>
</div>
<script>
let aurora={bank:0,pnl:0,trades:0,wins:0,losses:0},hft={bank:0,pnl:0,trades:0,wins:0,losses:0},trades=[],pnlHistory=[100,105,108,110,112,115];

var sc,ca,re,pt3,t=0;
function in3(){sc=new THREE.Scene();sc.background=new THREE.Color(0x030508);
ca=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);ca.position.z=25;
re=new THREE.WebGLRenderer({canvas:document.getElementById('c'),antialias:true});re.setSize(innerWidth,innerHeight);
var g=new THREE.BufferGeometry(),c=1200,p=new Float32Array(c*3),cl=new Float32Array(c*3);
for(var i=0;i<c;i++){p[i*3]=(Math.random()-0.5)*60;p[i*3+1]=(Math.random()-0.5)*60;p[i*3+2]=(Math.random()-0.5)*30;var C=new THREE.Color();C.setHSL(0.5+Math.random()*0.2,0.8,0.5);cl[i*3]=C.r;cl[i*3+1]=C.g;cl[i*3+2]=C.b;}
g.setAttribute('position',new THREE.BufferAttribute(p,3));g.setAttribute('color',new THREE.BufferAttribute(cl,3));
pt3=new THREE.Points(g,new THREE.PointsMaterial({size:0.08,vertexColors:true,transparent:true,opacity:0.8,blending:THREE.AdditiveBlending}));sc.add(pt3);
var gr=new THREE.GridHelper(50,25,0x00f5ff,0x0a1520);gr.position.y=-12;sc.add(gr);an()}
function an(){requestAnimationFrame(an);t+=0.001;pt3.rotation.y=t*0.1;ca.position.x=Math.sin(t)*3;ca.position.y=Math.cos(t*0.7)*2;ca.lookAt(0,0,0);re.render(sc,ca)}

async function fetchData(){
  try{
    // Use local API endpoint which proxies to Upstash
    var ar=await fetch('/api/aurora'),aurora=await ar.json();
    var hr=await fetch('/api/hft'),hft=await hr.json();
    var tr=await fetch('/api/trades'),trades=await tr.json();
    
    if(aurora && aurora.bank) window.aurora = aurora;
    if(hft && hft.bank) window.hft = hft;
    if(trades) window.trades = trades;
    
    pnlHistory.push((window.aurora.bank||0)+(window.hft.bank||0));
    if(pnlHistory.length>30)pnlHistory.shift();
  }catch(e){console.log('Error:',e);}
  updateDisplay();
}

function updateDisplay(){
  aurora = window.aurora || {bank:100,pnl:0,trades:0,wins:0,losses:0};
  hft = window.hft || {bank:100,pnl:0,trades:0,wins:0,losses:0};
  trades = window.trades || [];
  
  var tb=aurora.bank+hft.bank,tp=aurora.pnl+hft.pnl,tt=aurora.trades+hft.trades,tw=aurora.wins+hft.wins;
  var wr=tt>0?(tw/tt*100).toFixed(0):0;
  
  document.getElementById('totalBank').textContent='$'+tb.toFixed(2);
  var tpEl=document.getElementById('totalPnl');
  tpEl.textContent='$'+(tp>=0?'+':'')+tp.toFixed(2);
  tpEl.style.color=tp>=0?'var(--green)':'var(--red)';
  document.getElementById('totalTrades').textContent=tt;
  document.getElementById('winRate').textContent=wr+'%';
  document.getElementById('auroraBank').textContent='$'+aurora.bank.toFixed(0);
  document.getElementById('hftBank').textContent='$'+hft.bank.toFixed(0);
  document.getElementById('auroraVal').textContent='$'+aurora.bank.toFixed(2);
  document.getElementById('hftVal').textContent='$'+hft.bank.toFixed(2);
  
  var t1=document.getElementById('trades1'),t2=document.getElementById('trades2');
  t1.innerHTML='';t2.innerHTML='';
  trades.slice(0,10).forEach(function(tr,i){
    var tm = tr.time ? new Date(tr.time).toLocaleTimeString() : '';
    var d='<div class="ti '+(tr.result==='WIN'?'win':'loss')+'"><div><span style="font-weight:700">'+(tr.signal||'')+'</span> '+(tr.token||'')+(tr.leverage?' '+tr.leverage+'x':'')+'</div><div class="ts">'+tm+'</div><div style="color:'+(tr.profit>=0?'var(--green)':'var(--red)')+'">'+(tr.profit>=0?'+':'')+(tr.profit||0).toFixed(2)+'</div></div>';
    if(i<5)t1.innerHTML+=d;else t2.innerHTML+=d;
  });
  
  drawChart();
}

function drawChart(){
  var ca=document.getElementById('pnlChart'),ctx=ca.getContext('2d');
  ca.width=ca.offsetWidth;ca.height=ca.offsetHeight;
  var w=ca.width,h=ca.height;
  ctx.clearRect(0,0,w,h);
  if(pnlHistory.length<2)return;
  var mn=Math.min(...pnlHistory),mx=Math.max(...pnlHistory),rg=mx-mn||1;
  ctx.strokeStyle='#00ff88';ctx.lineWidth=2;ctx.beginPath();
  pnlHistory.forEach(function(v,i){var x=(i/(pnlHistory.length-1))*w,y=h-((v-mn)/rg)*(h-20)-10;if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);});
  ctx.stroke();
  ctx.lineTo(w,h);ctx.lineTo(0,h);ctx.closePath();
  var g=ctx.createLinearGradient(0,0,0,h);g.addColorStop(0,'rgba(0,255,136,0.3)');g.addColorStop(1,'rgba(0,255,136,0)');
  ctx.fillStyle=g;ctx.fill();
  ctx.fillStyle='#00ff88';ctx.font='bold 14px Orbitron';ctx.fillText('$'+pnlHistory[pnlHistory.length-1].toFixed(0),w-60,20);
}

onload=function(){
  in3();fetchData();
  setInterval(fetchData,3000);
  setTimeout(function(){document.getElementById('lo').style.display='none'},800);
}
onresize=function(){ca.aspect=innerWidth/innerHeight;ca.updateProjectionMatrix();re.setSize(innerWidth,innerHeight);}
</script>
</body>
</html>
